# FAP MCP Server

This is the Model Context Protocol (MCP) server for the Flutter Agent Protocol (FAP). It allows AI assistants like Claude Desktop to interact with your Flutter application.

## Prerequisites

*   **Node.js**: v16 or higher.
*   **Flutter App**: A Flutter app running with `fap_agent` installed and initialized.

## Installation

1.  **Install Dependencies**:
    ```bash
    npm install
    ```

2.  **Build the Server**:
    ```bash
    npm run build
    ```

## Configuration (Claude Desktop)

To use this with Claude Desktop, add the following to your `claude_desktop_config.json` (usually located at `~/Library/Application Support/Claude/claude_desktop_config.json` on macOS):

```json
{
  "mcpServers": {
    "flutter-agent": {
      "command": "node",
      "args": [
        "/ABSOLUTE/PATH/TO/YOUR/flutter-ai-testing/fap_mcp/dist/index.js"
      ]
    }
  }
}
```

**Important**: Replace `/ABSOLUTE/PATH/TO/YOUR/...` with the actual absolute path to the `dist/index.js` file generated by the build step.

## Usage

1.  **Start your Flutter App**: Ensure your app is running and the FAP Agent is listening (default port 9001).
2.  **Restart Claude Desktop**: If it was already open.
3.  **Interact**: You should now see the `flutter-agent` tools (like `list_elements`, `tap`, `enter_text`) available in Claude.

## Tools Available

*   `list_elements`: Get the current UI tree.
*   `tap(selector)`: Tap on a UI element.
*   `enter_text(selector, text)`: Enter text into a field.
*   `set_text(selector, text)`: Replace text in a field (requires focus).
*   `set_selection(selector, base, extent)`: Set cursor selection.
*   `scroll(selector, dx, dy)`: Scroll a view.
*   `drag(selector, dx, dy)`: Drag an element.
*   `long_press(selector)`: Long press an element.
*   `double_tap(selector)`: Double tap an element.
*   `get_route`: Get the current navigation route.
*   `get_logs`: Retrieve app logs.
*   `get_errors`: Retrieve captured errors.
*   `get_performance_metrics`: Retrieve frame timing metrics.
